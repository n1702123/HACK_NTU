
<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>台北綠健俠</title>

    <!-- Bootstrap Core CSS -->
    <link href="https://blackrockdigital.github.io/startbootstrap-round-about/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="https://blackrockdigital.github.io/startbootstrap-round-about/css/round-about.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


    <style>
  *{font-family:Arial,文泉驛正黑,WenQuanYi Zen Hei,儷黑 Pro,LiHei Pro,微軟正黑體,Microsoft JhengHei,標楷體,DFKai-SB,sans-serif;box-sizing:border-box}
		 
		.mytext {
			left: 0;
			position:absolute;
			text-align:center;
			color: black;
			top:50px;
			
			width: 100%
		}
		
		
		#myRight{
		    background-image: -webkit-linear-gradient(left,rgba(0,0,0,.0001) 0,rgba(0, 0, 0, 0) 100%);
			background-image: linear-gradient(to right,rgba(0,0,0,.0001) 0,rgba(0, 0, 0, 0) 100%); 
			height:100px; 
		}
		
    </style>

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">

            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

                <h1 style="color:white"><a style="color:white" href="./index.html"><b>台北綠健俠</b></a></h1>

            </div>

        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Content -->
    <div class="container">
	
		<div class="row">
			 <div class="col-lg-12">
				 <div class="col-lg-4">
                    <h2><b><span id="myTitle" ></span></b></h2> 
                     
                </div>
			 
			 </div>
		
		</div>

        <!-- Introduction Row -->
        <div class="row">
            <div class="col-lg-12">

                <div class="col-lg-6">
                    <h3><span><b>公車 可服務面積</b></span> </h3>
                    <h5><span id="busAreaText"></span> </h5>
                    
                    <div id="busMap" style="width:450px;height:300px"></div>
                </div>

                <div class="col-lg-6">
                    <h3><span><b>MRT 可服務面積</b></span> </h3>
                    <h5><span id="mrtAreaText"></span> </h5>
                    <div id="mrtMap" style="width:450px;height:300px"></div>
                </div>

               
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12">
			 
				 <div class="col-lg-6">
                    <h3><span><b>Ubike 可服務面積</b></span> </h3>
                    <h5><span id="ubikeAreaText"></span> </h5>
					<h5><span></span> </h5>
                    <div id="ubikeMap" style="width:450px;height:300px"></div>
                </div>
			
                <div class="col-lg-6">
                    <h3><span><b>公車彎繞程度</b></span> </h3>
                    <h5><span id="busCurveText"></span> </h5>
                    <h5><span>彎繞程度指標=公車路線行駛距離/實際路線最短距離</span> </h5>
                    <div id="busCurveMap" style="width:450px;height:300px"></div>
                </div>
				
            </div>
        </div>
		
		
		<div class="row">
		
			<div class="col-lg-6"> 
				<img  src="img11.JPG" style="height:100%;width:100%"  ></img>
			</div>
			
			<div class="col-lg-6"> 
				<img  src="img22.JPG" style="height:100%;width:100%"  ></img>
			</div>
		
		
		</div>
		
        <hr>
		
		<!-- <h2>Carousel Example</h2>  --> 
		
		<div class="row"  id="viewAA"  >
			 
            <div class="col-lg-12">
			
				<div id="myCarousel" class="carousel slide" data-ride="carousel"  
					  style='border-style: solid; border-width: 2px;background:#EBF5FF;'  >
  
					<!-- Wrapper for slides -->
					<div class="carousel-inner" id="helloText"   >
					 
				  
					</div>

					<!-- Left and right controls -->
					<a class="left carousel-control" href="#myCarousel" data-slide="prev"  id="myRight"   >
					  <span class="glyphicon glyphicon-chevron-left"></span>
					  <span class="sr-only">Previous</span>
					</a>
					<a class="right carousel-control" href="#myCarousel" data-slide="next"  id="myRight"  >
					  <span class="glyphicon glyphicon-chevron-right"></span>
					  <span class="sr-only">Next</span>
					</a>
				</div> 
				
			</div> 
			 
		</div>
		
		 

 
		<!-- Footer -->
		<footer>
			<div class="row">
				<div class="col-lg-12">
					  台大黑客松
				</div>
				<!-- /.col-lg-12 -->
			</div>
			<!-- /.row -->
		</footer>


    </div>
    <!-- /.container -->
	
	
	<div class="container">
	  
	</div>
	
	
	<hr>

	




    <!-- jQuery -->
    <script src="https://blackrockdigital.github.io/startbootstrap-round-about/js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="https://blackrockdigital.github.io/startbootstrap-round-about/js/bootstrap.min.js"></script>
    <script src='https://npmcdn.com/@turf/turf/turf.min.js'></script>
	
	
	
	<script>
 
		
 
		var myObj =  
		[
			[  "又到了大家最期待的星期五囉！ <br/><br/>  辛苦了一星期，明天一起搭乘綠色運輸，悠哉的上下班吧！<br/><br/> 明天交通局的吉祥物-小紅人跟小綠人會在捷運南京三民站、北門站、善導寺站及國父紀念館站陪伴大家上下班，只要跟小紅人小綠人拍照上傳FACEBOOK並標註 #綠色運輸日，就可以得到精美的紀念品，紀念品有木製筆筒、水壺等好康獎品，歡迎大家一起共襄盛舉，除了為城市環保盡一份心力以外，還可以拿到贈品喔！<br/><br/>"  
				+ "活動地點及時間：<br/><br/>"
				+ "捷運南京三民站：7:05-7:20<br/><br/>"
				+ "捷運北門站：7:40-7:55<br/><br/>"
				+ "捷運善導寺站：8:10-8:25<br/><br/>"
				+ "捷運國父紀念館站：8:40-8:55<br/><br/>" 
				+ "#綠色運輸日"
				+ "#GreenFriday"
				 
			],  // 國父紀念館(1)
			 
			[   
				"「慢活，慢行，慢慢來！」<br/><br/>愛奇兒與他的好友們這一天來當老師，教公車司機如何在公車時提供乘客最好的服務！<br/><br/>"+
				"因為一群孩子有「慢」的需求，當瞭解了，就更懂得關懷與尊重，<br/><br/>" +
				"於是這一天首都客運與臺北客運公司讓公車司機當學生，學習如何接待這些搭公車時需要「慢」的孩子。<br/><br/>" +
				"這一天，小老師們也搭著圓仔公車去動物園看圓仔，留下一個愉快又難忘的記憶呢！" 
				, 
				 
				"掃墓期間平日闢駛小35路公車<br/><br/>"+
				"為利民眾清明掃墓祭祖，提供平日掃墓民眾公車接駁服務，今年3月24日至28日、3月31日至4月3日由首都客運股份有限公司闢駛「小35路公車」，<br/><br/>"+
				"行駛路線為捷運動物園站至富德靈骨樓，營運時間為上午8時至17時，每小時於捷運動物園站準點發車、每半點於富德靈骨樓發車，採一段票收費，歡迎平日上山掃墓民眾可多加利用。民眾可於乘車前於公車資訊動態系統(5284.taipei.gov.tw/)查詢公車動態，以掌握公車及時到站資訊。<br/><br/>"+
				"有關掃墓期間之交通管制及輸運資訊可上臺北市政府交通局網站（http://www.dot.taipei.gov.tw/）及臺北市公共運輸處網站(http://www.pto.taipei.gov.tw/)查詢。<br/><br/>"+
				"詳情：http://www.pto.taipei.gov.tw/ct.asp?xItem=73376966&ctNode=22734&mp=117041 <br/><br/>"+
				"自行車禁行騎樓。 <br/><br/>"+
				"自行車超越行人前請說借過，再從左側緩慢通過並說謝謝。 <br/><br/>"+
				"查詢大臺北地區公車到站資訊、即時道路績效及停車格位請多利用 <br/><br/>"
				 
				,
				
				"春節假期看圓仔請搭乘大眾運輸工具及利用府前停車場<br/><br/>"+
				"臺北市立動物園大貓熊圓仔已於103 年1 月6 日(星期一)開展，因動物園周邊停車空間不足，因應春節假期參觀人潮眾多，<br/><br/>"+ 
				"臺北市政府交通局規劃以信義區府前停車場作為替代停車場，闢駛「123 路貓熊免費接駁專車」，串連信義商圈至動物園，並調高動物園週邊停車場費率。<br/><br/>"+
				"因應春節假期中南部遊客自行開車至動物園看圓仔 ，為避免動物園周邊停車場滿場造成周邊道路壅塞，交通局規劃將位於信義商圈的府前停車場做為替代停車場，配合貓熊開展的活動，<br/><br/>"+
				"春節期間初一至初五（1 月31 日至2 月4 日）及2 月8、9 日，民眾於取車時出示當日蓋有動物園任一戳章之府前停車場停車票卡，即可享有6 小時免停車費優惠，同時闢駛彩繪貓熊圖案之「123 路貓熊免費接駁專車」，<br/><br/>"+
				"串連信義商圈經由信義快速道路直達動物園，專車行經市政府、捷運市政府站、101 國際購物中心等，民眾可將車輛停放於府前停車場或捷運板南線、信義線轉乘（乘車資訊如附件1）。<br/><br/>"+
				"建議來自中南部遊客可利用府前停車場停車並規劃一日遊程，除搭乘「123 路貓熊免費接駁專車」至動物園參觀，亦可於信義商圈暢遊觀光，<br/><br/>"+
				"另來自宜蘭搭乘客運至市府轉運站之民眾，可至捷運市政府站2 號出口搭乘「123 路貓熊免費接駁專車」，南港、信義及汐止區等民眾可多加利用。 <br/><br/>"+
				"為避免春節期間動物園周邊停車場滿場造成道路擁塞，除上述措施外，同時調高動物園站地下停車場、河川地停車場停車費率為每小時60 元，<br/><br/>"+
				"捷運木柵機場停車場計次收費為每次150 元，捷運木柵站轉乘停車場為每小時40 元（各停車場費率如附件2）。民眾可利用「臺北好行」及「臺北好停車」APP，預先掌握動物園周邊停車場剩餘車位數。<br/><br/>"+
				"交通局建議民眾多利用大眾運輸前往，省時方便又快速，是最聰明的選擇。<br/><br/>"
				  
				,
				
				"來臺北過好年‧到臺北搭「貓熊專車123路」去動物園！<br/><br/>"+
				"「貓熊專車123路（臺北市政府－捷運動物園站）」免費接駁公車從103年1月11日正式通車營運，大家一同和活潑的大貓熊圓仔一起支持大眾運輸！ <br/><br/>"+
				"為鼓勵民眾持續利用多元的大眾運輸方式前往臺北市立動物園參觀大貓熊圓仔和其他可愛的動物，臺北市公共運輸處從103年1月25日起，每週提供不一樣的小贈品，讓市府路上之「市政府（市府）」站及忠孝東路之「捷運市政府站」搭乘「貓熊專車123路」前往「捷運動物園站」的乘客，<br/><br/>"+
				"除了可以免費又便捷的搭乘「貓熊專車123路」快速往返信義商圈和臺北市立動物園外，還有免費贈品可以拿！<br/><br/>"+
				"每日限量送完為止，春節期間初一至初五的贈品是由動物園提供的貓熊紅包袋，讓大家開開心心過好年。<br/><br/>"+
				"臺北市公共運輸處表示，「貓熊專車123路」自103年1月11日起至103年2月9日止的例假日及春節連續假期，配合動物園開園時間，於103年1月11、12、18、19、25、26及31日與103年2月1、2、3、4、8及9日（共13天）的7時30分至18時行駛，採班距10至15分鐘1班，以疏解大貓熊圓仔展出初期大量之參觀遊客。<br/><br/>"+
				"臺北市停車管理工程處也配合於「貓熊專車123路」行駛日期，開放停放自小客車於信義區府前廣場地下停車場前往臺北市立動物園的民眾，持停車票卡在臺北市立動物園加蓋戳章，即可享前6小時免費停車優惠，更可直接轉乘免費「貓熊專車123路」前往，歡迎多加利用。<br/><br/>"+
				"此外，臺北市立動物園特別提醒民眾快速入園看大貓熊圓仔的小撇步：「事先儲值悠遊卡並刷卡入園，節省排隊購票時間。」，讓大家可以便捷又快速的進入園區！<br/><br/>"
			
			
			
			],  // 動物園 (5)
			
			
			[ 
				"竹子湖海芋季交通管制 請搭乘公車上山賞花！<br/><br/>" +
				"臺北市政府產業發展局規劃竹子湖海芋季活動自3月24日(五)起跑，至4月23日結束，將吸引大量人車潮上山賞花，為疏解陽明山竹子湖地區周邊道路交通，其相關交通管制措施如下：<br/><br/>" +
				"一、 交通管制部分：海芋季期間例假日及連續假日（包括3/25、3/26、4/1、4/2、4/3、4/4、4/8、4/9、4/15、4/16、4/22、4/23）每日上午9時至下午6時，湖田橋往西經海芋大道至往中正山之岔路口採順時鐘單行管制；湖田橋往東至頂湖段前為雙向通行。頂湖段採單向通行且禁止迴轉，車輛由新闢石板路往陽金公路離開。另仰德大道實施通行證管制，上山管制點於仰德大道與至誠路口，管制時間由上午8時至下午3時；下山管制點於陽明路一段43巷口，管制時間為下午2時至下午6時，管制對象為自用小客(貨)車。<br/><br/>" +
				"二、 公車輸運服務部分，為配合海芋季管制、減少私人運具使用及降低陽明山停車空間不足所衍生之交通擁塞，民眾可利用以下公車接駁上山： <br/> " +
				"(一)直達竹子湖<br/>" +
				"1.捷運石牌站：休閒公車128(假日行駛)及小8路公車。<br/>" +
				"2.捷運北投站：休閒公車129(假日行駛)及小9（台灣好行北投竹子湖線）。<br/>" +
				"  (二)先搭乘公車至「陽明山公車總站」下車，再轉乘128(假日行駛)、129(假日行駛)、小8、小9（台灣好行北投竹子湖線）及花季專車131路公車至竹子湖：<br/>" +
				"1.臺北車站：260(含區間車)。<br/>" +
				"2.捷運劍潭站：260(含區間車)、紅5、休閒公車109(假日行駛)、111路(假日行駛)及花季專車127路公車（花季專車127為花季及海芋季期間假日行駛)。<br/>" +
				"3.捷運北投站：230路公車。<br/><br/>"
  
			, 
			
				"3月20日起未來兩週重大活動及施工，請用路人提早因應<br/><br/>" +
				"臺北市政府交通順暢小組彙整未來兩週（3/20-4/4）預期影響交通之重大活動及工程施工案件（ http://www.dot.gov.taipei/public/Attachment/732014592580.pdf ），提醒用路者提早因應。<br/><br/>" +
				"活動部分：陽明山2017年竹子湖海芋季自3月24日至4月23日止，除仰德大道例假日管制小客車通行外，竹子湖地區假日實施車輛單向通行管制；信義區2017國際自由車環臺賽於3月26日舉行，管制市府路、新仁愛路（府前廣場）及仁愛路1至4段路段；松山區演習活動，分別於3月24日、27日及30日管制小巨蛋周邊路段（北寧路、八德路、敦化北路及南京東路）；106年清明掃墓期間，自3月25日至4月4日止每逢假日管制富德公墓、南港軍人公墓及陽明山第一公墓等墓區周邊道路；信義區慈恩園106年清明法會，自3月25日至4月4日止每逢假日管制和平東路三段631巷道路。<br/><br/>" +
				"施工部分：士林區及北投區在格致路附近有管線工程（日間離峰及夜間時段施工）；士林區重陽橋耐震補強工程，於日間離峰及夜間時段施工；萬華區華中橋自行車道工程全日封閉機車道；忠孝西路路型改善工程，全日於北門周邊進行；信義區（信義路6段、福德街及中坡南路）及中正區（南海路及萬大路）全日有捷運工程施工；士林區及北投區北投士林科技園區工程全日封閉建德橋。<br/><br/>" +
				"交通局建議民眾陽明山花季期間，因仰德大道假日實施小客車管制，請搭乘大眾交通運輸工具上山；清明掃墓期間，各大墓區均有提供免費接駁車，民眾可以多加使用；自行開車時建議避開活動或施工之地點及時段，或提前改道行駛，以免行程延誤，行經活動或施工地點時，請遵守標示並依照員警或義交指揮小心駕駛。<br/><br/>" 
				
			,
			
				"3月18日起清明掃墓墓區交通管制<br/>" +
				"請利用大眾運輸轉乘免費掃墓公車前往<br/>" +
				"今（106）年臺北市殯葬管理處宣布清明掃墓於3月18日起啟動，因公墓區(富德公墓、軍人公墓、崇德公墓、陽明山第一公墓)道路狹窄，為提供民眾便利之交通服務，3月18日、19日、25日、26日及4月1日、2日、3日、4日等8日（上午5時30分至下午5時），墓區周邊道路及主要入口實施交通管制，同時配合闢駛5線免費掃墓公車及復康巴士，供掃墓民眾搭乘。有關今年清明掃墓期間各墓區交通管制及公車輸運措施如下：<br/><br/>" +
				"一、 富德及軍人公墓<br/>" +
				"（一） 管制點及管制車種<br/>" +
				"  1. 禁止所有車輛(含汽、機車)通行之管制點<br/>" +
				"     (1) 崇德街與富陽街口。<br/>" +
				"     (2) 研究院路4段與木柵路4段159巷三岔路口。<br/>" +
				"     (3) 文山區西寒寺前三岔路口。<br/>" +
				"  2. 禁止汽車通行(機車可通行)之管制點<br/>" +
				"     (1) 文山區木柵路5段43巷口。 <br/>" +
				
				"     (1) 文山區木柵路5段43巷口。 <br/>" +
				"     (2) 南港區研究院路3段（中華技術學院旁）。 <br/>" +
				"  3. 管制車輛單向通行：南港區研究院路與掃墓公車調度站口。<br/>" +
				"  4. 上揭管制點僅准許掃墓公車、復康巴士及執行公務車輛通行。<br/>"
 
			 
			],  // 陽明山 (5)
			 
		];
		 
		var myFacebook = [ 
			[ 'video,high,high,high,high,low,low,low,low,Thursday,17,https://www.facebook.com/170520926428695/posts/737725213041594' ]  
			,  
			[
				'photo,high,medium,high,high,low,low,low,low,Saturday,9,https://www.facebook.com/170520926428695/posts/337735263040593',
				'status,low,low,low,low,low,low,low,low,Friday,9,https://www.facebook.com/170520926428695/posts/298334156980704',
				'status,low,medium,low,low,low,low,low,low,Friday,9,https://www.facebook.com/170520926428695/posts/280492942098159',
				'status,low,low,low,low,low,low,low,low,Friday,8,https://www.facebook.com/170520926428695/posts/280465825434204' 
			] 
			,  
			[
				'link,medium,medium,high,medium,low,low,low,low,Thursday,13,https://www.facebook.com/170520926428695/posts/773899649424150',
				'link,low,medium,low,low,low,low,low,low,Monday,15,https://www.facebook.com/170520926428695/posts/772275776253204',
				'photo,medium,low,low,medium,low,low,low,low,Tuesday,16,https://www.facebook.com/170520926428695/posts/768940359920079' 
			]   
		];
 
	</script>

	 
    <script>
      
        var state = {
            lat: null,
            lng: null,
            walkDistance: 600,
            tripTime: 30,
            weekType: 6,
            transitType: 'YMB',
            startTime: '0800',
			no : null,
			type : null,
			title : ""
        }
        var lat;
        var lng;
		 

        var urlParams;
        (window.onpopstate = function () {
            var match,
                pl = /\+/g,  // Regex for replacing addition symbol with a space
                search = /([^&=]+)=?([^&]*)/g,
                decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
                query = window.location.search.substring(1);

            urlParams = {};
            while (match = search.exec(query))
                urlParams[decode(match[1])] = decode(match[2]);

            console.log("urlParams :", urlParams);  // 取得參數
            state.lat = parseFloat(urlParams.lat);
            state.lng = parseFloat(urlParams.lng);
			
			state.type = urlParams.type;
			state.no = urlParams.no;
			state.title = urlParams.title;
			
        })();
		
		$("#myTitle").html(state.title + " 分析指標");
		
		if(state.type!=1){
		
			var mytemp1 = myObj[state.no]; 
			var mytemp2 = myFacebook[state.no];
		
			var tempString = ""; 
			for(var i = 0 ; i < mytemp1.length ; i++){
			  
				var getText = mytemp1[i];
				var getFBinfo = mytemp2[i].split(",");
				
			  
				console.log("getFBinfo:",getFBinfo);
					
				if(i == 0){
					tempString = tempString + "<div class='item active' >";
				}else{
					tempString = tempString + "<div class='item'  >";
				}
				
					tempString = tempString + "<div class='col-lg-10'  >";
				 
						tempString = tempString + "<div  class='mytext'   >"+ mytemp1[i] +"</div> ";
							 
					tempString = tempString + "</div>"; // col-lg-10
					 
					tempString = tempString + "<div  class='col-lg-2' style='border-style: solid; border-width: 2px;' >"; // col-lg-2
					tempString = tempString + "留言:"+getFBinfo[2]+"<br/><br/>";
					tempString = tempString + "分享數:"+getFBinfo[3]+"<br/><br/>";  
					tempString = tempString + "按讚數:"+getFBinfo[4]+"<br/><br/>";  
					tempString = tempString + "大心:"+getFBinfo[5]+"<br/><br/>";  
					tempString = tempString + "哈哈:"+getFBinfo[6]+"<br/><br/>";  
					tempString = tempString + "嗚:"+getFBinfo[7]+"<br/><br/>";
					tempString = tempString + "怒:"+getFBinfo[8]+"<br/><br/>";  
					tempString = tempString + "PO文日期:"+getFBinfo[9]+"<br/><br/>";  
					tempString = tempString + "PO文小時:"+getFBinfo[10]+"<br/><br/>";  
					tempString = tempString + "PO種類:"+getFBinfo[0]+"<br/>";  
					tempString = tempString + "<a href='"+getFBinfo[11]+"'>超連結</a>";  
					tempString = tempString + "</div>"; 
				 
				tempString = tempString + "</div>";  //  class='item' end
				
			}
			
			$("#helloText").html(tempString);
			 
		
		}else{ 
			$("#viewAA").empty();
			$("#viewAA").hide(); 
		}
		
		
	
		
		/////////////
 
 
        var busMap;
        var mrtMap;
        var ubikeMap;
        var busCurveMap;//彎繞程度

        var busLayer;
        var mrtLayer;
        var ubikeLayer;
        var busCurveLayer;

        var busArea;
        var mrtArea;
        var ubikeArea;
        function initMap() {
            busLayer = new google.maps.Data();
            mrtLayer = new google.maps.Data();
            ubikeLayer = new google.maps.Data();
            busCurveLayer = new google.maps.Data();



            busMap = new google.maps.Map(document.getElementById('busMap'), {
				disableDefaultUI: true,
                center: { lat: state.lat, lng: state.lng },
                zoom: 12
            });

            busCurveMap = new google.maps.Map(document.getElementById('busCurveMap'), {
				disableDefaultUI: true,
                center: { lat: state.lat, lng: state.lng },
                zoom: 12
            });

            mrtMap = new google.maps.Map(document.getElementById('mrtMap'), {
				disableDefaultUI: true,
                center: { lat: state.lat, lng: state.lng },
                zoom: 12
            });

            ubikeMap = new google.maps.Map(document.getElementById('ubikeMap'), {
				disableDefaultUI: true,
                center: { lat: state.lat, lng: state.lng },
                zoom: 12
            });
            var markerB = new google.maps.Marker({
				disableDefaultUI: true,
                position: { lat: state.lat, lng: state.lng },
                map: busMap
            });
            var markerM = new google.maps.Marker({
				disableDefaultUI: true,
                position: { lat: state.lat, lng: state.lng },
                map: mrtMap
            });
            var markerY = new google.maps.Marker({
				disableDefaultUI: true,
                position: { lat: state.lat, lng: state.lng },
                map: ubikeMap
            });
            var markerBusCurve = new google.maps.Marker({
				disableDefaultUI: true,
                position: { lat: state.lat, lng: state.lng },
                map: busCurveMap
            });

            //得到公車捷運youbike服務面積
            $.ajax({
                url: "http://demo.datarget.com.tw/TripTaipei/getTripArea/GeoJson",
                data: {
                    lat: state.lat,
                    lng: state.lng,
                    tripTime: state.tripTime,
                    weekType: state.weekType,
                    startTime: state.startTime,
                    transitType: state.transitType,
                    walkDistance: state.walkDistance,
                },
                dataType: "jsonp",
                jsonpCallback: "callback",//callback回來的fucntion名稱叫做callback  springmvc裡面設定callback名稱
                success: function (response) {
                    if (response.result === '0') {
                        alert("無資料")
                    } else {
                        drawArea(response)
                    }

                },
                error: function (error) {
                    console.error(error);
                }
            });
            //計算彎繞程度
            $.ajax({
                url: "http://demo.datarget.com.tw/TripTaiwan/getBusRouteCurveIndex",
                data: {
                    lat: state.lat,
                    lng: state.lng,
                     walkDistance: state.walkDistance,
                    //walkDistance: 500,
                },
                dataType: "jsonp",
                success: function (response) {
                    drawCurveIndex(response);

                },
                error: function (error) {
                    console.error(error);
                }
            });
            //劃出彎繞公車路線
            $.ajax({
                url: "http://demo.datarget.com.tw/TripTaiwan/getBusRoute",
                data: {
                    lat: state.lat,
                    lng: state.lng,
                         walkDistance: state.walkDistance,
                },
                dataType: "jsonp",
                success: function (response) {
                    drawBusRoute(response);

                },
                error: function (error) {
                    console.error(error);
                }
            });
        }

        function drawBusRoute(data) {
            busCurveLayer.setStyle({
                fillColor: '#00B3FD',
                fillOpacity: 0.9,
                strokeColor: '#00B3FD',
                strokeOpacity: 0.9,
                strokeWeight: 3,
                zIndex: 996
            });
            busCurveLayer.addGeoJson(jQuery.parseJSON(data.result));
            busCurveLayer.setMap(busCurveMap);
        }

        //畫上各運具服務面積
        function drawArea(data) {
            ubikeLayer.setStyle({
                fillColor: '#f39c12',
                fillOpacity: 0.6,
                strokeColor: '#FFFFFF',
                strokeOpacity: 0.8,
                strokeWeight: 1.2,
                zIndex: 996
            });

            mrtLayer.setStyle({
                fillColor: '#1269f3',
                fillOpacity: 0.3,
                strokeColor: '#FFFFFF',
                strokeOpacity: 0.8,
                strokeWeight: 1.2,
                zIndex: 991
            });

            busLayer.setStyle({
                fillColor: '#12f39c',
                fillOpacity: 0.45,
                strokeColor: '#FFFFFF',
                strokeOpacity: 0.8,
                strokeWeight: 1.2,
                zIndex: 995
            });

            if (data.result.B) {
                busLayer.addGeoJson(jQuery.parseJSON(data.result.B));
                busArea = turf.area(jQuery.parseJSON(data.result.B)) / 1000 / 1000
            }
            if (data.result.M) {
                mrtLayer.addGeoJson(jQuery.parseJSON(data.result.M));
                mrtArea = turf.area(jQuery.parseJSON(data.result.M)) / 1000 / 1000
            }
            if (data.result.Y) {
                ubikeLayer.addGeoJson(jQuery.parseJSON(data.result.Y));
                ubikeArea = turf.area(jQuery.parseJSON(data.result.Y)) / 1000 / 1000
            }
            //四捨五入
            busArea = Math.round(busArea * 100) / 100
            mrtArea = Math.round(mrtArea * 100) / 100
            ubikeArea = Math.round(ubikeArea * 100) / 100
            $("#busAreaText").text("服務面積:" + busArea + "平方公里")
            $("#mrtAreaText").text("服務面積:" + mrtArea + "平方公里")
            $("#ubikeAreaText").text("服務面積:" + ubikeArea + "平方公里")
            busLayer.setMap(busMap);
            mrtLayer.setMap(mrtMap);
            ubikeLayer.setMap(ubikeMap);
        }

        function drawCurveIndex(_data) {
            var index = 0;
            var count = 0;
            aaa=_data;
            var data= _data.result;
            for (var i in data) {
                console.log("~~index=" + data[i].index)
                if (data[i].index > 1 && data[i].index < 3) {
                    console.log("index="+data[i].index)
                    index = parseFloat(data[i].index) + index;
                    count++;
                }
            }
            var totalIndex=Math.round(index/count*1000)/1000;
            console.log("index="+ index)
            console.log("count=" + count)
            $("#busCurveText").text("公車彎繞程度指標:"+ totalIndex);
        }
		
		
		
		
		$(document).ready(function(){
		 
		});
		
		
		
		
    </script>
	

</body>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCrPV8XZA8_INsW2NicR-2_wxNHW9S4v48&callback=initMap" async defer></script>




</html>